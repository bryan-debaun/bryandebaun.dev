# bryandebaun.dev

Personal website for **Bryan DeBaun** â€” built with Next.js, TypeScript, and Tailwind CSS.

## Local development

```bash
npm install
npm run dev
```

Open [http://localhost:3000](http://localhost:3000).

Note: the `build` script enforces `NODE_ENV=production` to ensure consistent production builds even when a system-level `NODE_ENV` differs. Use `npm run dev` for development runs.

## Troubleshooting

### Missing devDependencies when NODE_ENV is set to `production`

If you have `NODE_ENV=production` set at the system or user level, `npm` may skip installing `devDependencies` which are required for local builds (for example `contentlayer2`, `tsx`, and the OpenAPI generator). If `npm run build` prints an error about `contentlayer2` or other missing packages, fix it by running:

```bash
npm ci --include=dev
```

Or install the missing packages directly:

```bash
npm install --save-dev contentlayer2 tsx swagger-typescript-api
```

## Fonts & Typography

This site uses **Inter** for body/UI text and **Orbitron** for display/headings. Fonts are loaded via Next.js' `next/font` helper in `src/app/layout.tsx` and the typographic tokens (font-family and type scale) are defined in `src/styles/tokens.css` and applied in `src/app/globals.css`.

To update fonts:

- Prefer `next/font` usage in `src/app/layout.tsx` (`Inter` / `Orbitron`) for automatic subsetting and preload.
- If self-hosting is required, add WOFF2 subsets to `public/fonts/` and update `layout.tsx` and the ADR in `docs/adr/0001-choose-fonts.md`.
- Update `src/styles/tokens.css` to adjust the type scale or fallbacks.

## Deployment

This project is designed for deployment to Vercel. Connect your GitHub repo in Vercel and add the custom domain (`bryandebaun.dev`) after DNS is configured.

## Content checks & CI (Issue #17) ðŸ”§

This repository includes content quality tooling and a CI job to run checks on PRs and pushes to `main`:

- Tools: `remark` (lint), `cspell` (spell-check), `markdown-link-check` (link validation)
- Run locally: `npm run content:checks` (runs linters, spell-check, and link checks)
- Configs: `.remarkrc.json`, `cspell.json`, `.markdown-link-check.json`
- CI workflow: `.github/workflows/content-checks.yml` runs checks on pull requests and pushes to `main`

If a new word is flagged by `cspell`, add it to `cspell.json` under `words`.

## Accessibility & visual regression ðŸ§­âœ…

The repository includes a small Playwright-based audit script used in CI to capture accessibility reports and full-page screenshots for visual review.

- Run locally: `npm run a11y:local -- --url http://localhost:3000 --outDir artifacts/a11y` (the script will capture `/`, `/about`, and `/philosophy` by default)
- CI: `npm run a11y:ci` is wired into the `a11y-visual.yml` workflow and uploads artifacts for per-PR review
- The script writes screenshots, `axe` results, touch-target reports, and optional Lighthouse HTML per viewport and theme. Use these artifacts for visual diffing or to triage accessibility issues.

## Content frontmatter & private semantics ðŸ“„ðŸ”’

Content is authored as MDX under `src/content/` and parsed by Contentlayer. Frontmatter fields available to `Post` and `Philosophy` documents include:

- `title` (string) â€” required
- `date` (date) â€” optional
- `summary` (string) â€” optional
- `tags` (list of strings) â€” optional
- `reading` (json) â€” optional; used by `NowReading` and `BookNote` components
- `ogImage` (string) â€” optional; for open graph
- `private` (boolean) â€” optional, default `false`; when `true`, the document is generated by Contentlayer but is excluded from public listings, sitemaps, and RSS feeds. NOTE: `private` is an editorial flag (not access control); treat it as a policy signal when publishing.

When adding content, prefer placing posts in `src/content/posts/` and notes in `src/content/philosophy/`. The `npm run content:checks` script will verify Contentlayer output includes generated documents for CI.

## Notes

- MDX/Contentlayer integration is planned, but currently the `next-contentlayer` package is incompatible with Next.js 16; see Issue #2 for tracking.
- CI runs on push and PRs and performs build and lint checks.

### PWA icons / Troubleshooting âš ï¸

- If you see an outdated or incorrect icon after installing the PWA (for example, an old `omega` icon), Chrome may be caching the manifest or icon files. Try the following to refresh the installed app:
  - Open Chrome > More tools > Clear browsing data and clear "Cached images and files" for the site, or use an Incognito/fresh profile to test installation.
  - On the site, open DevTools > Application > Manifest and confirm the icons listed match `/public/icons` (look for `wolf-` or `badge-` assets).
  - Re-install the PWA (Chrome > Install app) after clearing site data.

- Developers: the icon generator defaults to `public/icons/wolf.svg`. Run `npm run icons:generate` to regenerate PNG assets into `public/icons/`.
- CI will run `npm run verify:no-omega` (added) to prevent accidental re-introduction of legacy `omega` references.

## GitHub API access

For some pages (like the Projects listing) this site can fetch repository metadata from the GitHub API. To increase API rate limits and avoid unauthenticated throttling in CI or development, you can optionally set a `GITHUB_TOKEN` in your environment (e.g., `.env.local`). The helper used by the site honors `GITHUB_TOKEN` when present and will fetch with ISR-style caching (24h by default).

Example `.env.local` (do NOT commit):

```
GITHUB_TOKEN=ghp_your_personal_access_token_here
```

In CI, prefer using the built-in `secrets.GITHUB_TOKEN` or a minimal-scope PAT stored in your provider secrets (Vercel/GitHub Actions).
